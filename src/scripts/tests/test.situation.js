import { assert } from 'chai'
import { itParam } from 'mocha-param'

import { createProfil } from './helpers.js'

import AlgorithmeOrientation from '../algorithme/orientation.js'
import { joursAvant } from '../utils.js'

// On parcourt tous les cas possibles par colonnes.
const matrice = [
    {
        description: 'Positif et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_symptomes_actuels_graves',
        statut: 'positif-symptomatique-urgent',
        conseils: 'symptomes-actuels-positif-critique',
    },
    {
        description: 'Positif et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_symptomes_actuels',
        statut: 'symptomatique-positif',
        conseils: 'depistage-positif-symptomatique',
    },
    {
        description: 'Positif et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_symptomes_passes',
        statut: 'symptomatique-positif',
        conseils: 'symptomes-passes-positif',
    },
    {
        description: 'Positif et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_contact_a_risque',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_contact_a_risque_meme_lieu_de_vie',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_contact_pas_vraiment_a_risque',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif et symptômes actuels autres',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_asymptomatique',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_asymptomatique',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif (variante britannique) et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_symptomes_actuels_graves',
        statut: 'positif-symptomatique-urgent',
        conseils: 'symptomes-actuels-positif-critique',
    },
    {
        description: 'Positif (variante britannique) et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_symptomes_actuels',
        statut: 'symptomatique-positif',
        conseils: 'depistage-positif-symptomatique',
    },
    {
        description: 'Positif (variante britannique) et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_symptomes_passes',
        statut: 'symptomatique-positif',
        conseils: 'symptomes-passes-positif',
    },
    {
        description: 'Positif (variante britannique) et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_contact_a_risque',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description:
            'Positif (variante britannique) et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_contact_a_risque_meme_lieu_de_vie',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif (variante britannique) et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_contact_pas_vraiment_a_risque',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif (variante britannique) et symptômes actuels autres',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_asymptomatique',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description: 'Positif (variante britannique) et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20I/501Y.V1',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_asymptomatique',
        statut: 'asymptomatique',
        conseils: 'depistage-positif-asymptomatique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_symptomes_actuels_graves',
        statut: 'positif-symptomatique-urgent',
        conseils: 'symptomes-actuels-positif-critique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_symptomes_actuels',
        statut: 'symptomatique-positif-variante-d-interet',
        conseils: 'depistage-positif-variante-d-interet-symptomatique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_symptomes_passes',
        statut: 'symptomatique-positif-variante-d-interet',
        conseils: 'symptomes-passes-positif-variante-d-interet',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_contact_a_risque',
        statut: 'asymptomatique-variante-d-interet',
        conseils: 'depistage-positif-variante-d-interet-asymptomatique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_contact_a_risque_meme_lieu_de_vie',
        statut: 'asymptomatique-variante-d-interet',
        conseils: 'depistage-positif-variante-d-interet-asymptomatique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_contact_pas_vraiment_a_risque',
        statut: 'asymptomatique-variante-d-interet',
        conseils: 'depistage-positif-variante-d-interet-asymptomatique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et symptômes actuels autres',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_asymptomatique',
        statut: 'asymptomatique-variante-d-interet',
        conseils: 'depistage-positif-variante-d-interet-asymptomatique',
    },
    {
        description:
            'Positif (variante sud-africaine ou brésilienne) et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            depistage_variante: '20H/501Y.V2_ou_20J/501Y.V3',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'positif_variante_d_interet_asymptomatique',
        statut: 'asymptomatique-variante-d-interet',
        conseils: 'depistage-positif-variante-d-interet-asymptomatique',
    },
    {
        description: 'Négatif et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_symptomes_actuels_graves',
        statut: 'symptomatique-urgent',
        conseils: 'symptomes-actuels-sans-depistage-critique',
    },
    {
        description: 'Négatif et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_symptomes_actuels',
        statut: 'symptomatique-negatif',
        conseils: null,
    },
    {
        description: 'Positif antigénique et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_symptomes_actuels_graves',
        statut: 'positif-symptomatique-urgent',
        conseils: 'symptomes-actuels-positif-critique',
    },
    {
        description: 'Positif antigénique et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_symptomes_actuels',
        statut: 'symptomatique-antigenique-positif',
        conseils: 'depistage-positif-antigenique-symptomatique',
    },
    {
        description: 'Positif antigénique et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_symptomes_passes',
        statut: 'symptomatique-antigenique-positif',
        conseils: 'symptomes-passes-positif-antigenique',
    },
    {
        description: 'Positif antigénique et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_contact_a_risque',
        statut: 'asymptomatique-positif-antigenique',
        conseils: 'depistage-positif-antigenique-asymptomatique',
    },
    {
        description: 'Positif antigénique et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_contact_a_risque_meme_lieu_de_vie',
        statut: 'asymptomatique-positif-antigenique',
        conseils: 'depistage-positif-antigenique-asymptomatique',
    },
    {
        description: 'Positif antigénique et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_contact_pas_vraiment_a_risque',
        statut: 'asymptomatique-positif-antigenique',
        conseils: 'depistage-positif-antigenique-asymptomatique',
    },
    {
        description: 'Positif antigénique et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'positif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'antigenique_positif_asymptomatique',
        statut: 'asymptomatique-positif-antigenique',
        conseils: 'depistage-positif-antigenique-asymptomatique',
    },
    {
        description: 'Négatif antigénique et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_symptomes_actuels',
        statut: 'symptomatique-negatif',
        conseils: null,
    },
    {
        description: 'Négatif antigénique et symptômes actuels et fragile',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
            age: 70,
        },
        situation: 'antigenique_negatif_fragile_symptomes_actuels',
        statut: 'antigenique-negatif-fragile',
        conseils: 'antigenique-negatif-fragile',
    },
    {
        description: 'Négatif et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_symptomes_passes',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Négatif antigénique et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_symptomes_passes',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Négatif et symptômes passés + personne fragile',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
            age: 70,
        },
        situation: 'negatif_symptomes_passes',
        statut: 'personne-fragile',
        conseils: null,
    },
    {
        description: 'Négatif antigénique et symptômes passés + personne fragile',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'antigenique',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
            age: 70,
        },
        situation: 'antigenique_negatif_fragile_symptomes_passes',
        statut: 'antigenique-negatif-fragile',
        conseils: 'antigenique-negatif-fragile',
    },
    {
        description: 'Négatif et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_symptomes_passes',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Négatif et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_contact_a_risque',
        statut: 'contact-a-risque-avec-test',
        conseils: 'contact-a-risque',
    },
    {
        description: 'Négatif et contact à risque + variante d’intérêt',
        profil: {
            contact_a_risque: true,
            contact_a_risque_variante_d_interet: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_contact_a_risque_variante_d_interet',
        statut: 'contact-a-risque-variante-d-interet-avec-test',
        conseils: 'contact-a-risque-variante-d-interet',
    },
    {
        description: 'Négatif et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_contact_a_risque_meme_lieu_de_vie',
        statut: 'contact-a-risque-meme-lieu-de-vie',
        conseils: 'contact-a-risque-meme-lieu-de-vie',
    },
    {
        description: 'Négatif et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Négatif et contact pas vraiment à risque + personne fragile',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
            age: 70,
        },
        situation: 'negatif_contact_pas_vraiment_a_risque',
        statut: 'personne-fragile',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Négatif et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Négatif et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_asymptomatique',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Négatif et rien de tout ça + personne fragile',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
            age: 70,
        },
        situation: 'negatif_asymptomatique',
        statut: 'personne-fragile',
        conseils: null,
    },
    {
        description: 'Négatif et rien de tout ça + foyer fragile',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'negatif_asymptomatique',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'En attente et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_symptomes_actuels_graves',
        statut: 'symptomatique-urgent',
        conseils: 'symptomes-actuels-sans-depistage-critique',
    },
    {
        description: 'En attente et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_symptomes_actuels',
        statut: 'symptomatique-en-attente',
        conseils: 'symptomes-actuels-en-attente',
    },
    {
        description: 'En attente et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_symptomes_passes',
        statut: 'symptomatique-en-attente',
        conseils: 'symptomes-passes-en-attente',
    },
    {
        description: 'En attente et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_contact_a_risque',
        statut: 'contact-a-risque-avec-test',
        conseils: 'contact-a-risque',
    },
    {
        description: 'En attente et contact à risque + variante d’intérêt',
        profil: {
            contact_a_risque: true,
            contact_a_risque_variante_d_interet: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_contact_a_risque_variante_d_interet',
        statut: 'contact-a-risque-variante-d-interet-avec-test',
        conseils: 'contact-a-risque-variante-d-interet',
    },
    {
        description: 'En attente et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_contact_a_risque_meme_lieu_de_vie',
        statut: 'contact-a-risque-meme-lieu-de-vie',
        conseils: 'contact-a-risque-meme-lieu-de-vie',
    },
    {
        description: 'En attente et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_contact_pas_vraiment_a_risque',
        statut: 'en-attente',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'En attente et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'en_attente',
            _depistage_start_date: new Date().toJSON(),
        },
        situation: 'en_attente_asymptomatique',
        statut: 'en-attente',
        conseils: null,
    },
    {
        description: 'Pas testé et symptômes actuels graves',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
            depistage: false,
        },
        situation: 'pas_teste_symptomes_actuels_graves',
        statut: 'symptomatique-urgent',
        conseils: 'symptomes-actuels-sans-depistage-critique',
    },
    {
        description: 'Pas testé et symptômes actuels',
        profil: {
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
            depistage: false,
        },
        situation: 'pas_teste_symptomes_actuels',
        statut: 'symptomatique-sans-test',
        conseils: 'symptomes-actuels-sans-depistage',
    },
    {
        description: 'Pas testé et symptômes passés',
        profil: {
            symptomes_passes: true,
            depistage: false,
        },
        situation: 'pas_teste_symptomes_passes',
        statut: 'symptomatique-sans-test',
        conseils: 'symptomes-passes-sans-depistage',
    },
    {
        description: 'Pas testé et contact à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
            depistage: false,
        },
        situation: 'pas_teste_contact_a_risque',
        statut: 'contact-a-risque-sans-test',
        conseils: 'contact-a-risque',
    },
    {
        description: 'Pas testé et contact à risque + variante d’intérêt',
        profil: {
            contact_a_risque: true,
            contact_a_risque_variante_d_interet: true,
            depistage: false,
        },
        situation: 'pas_teste_contact_a_risque_variante_d_interet',
        statut: 'contact-a-risque-variante-d-interet-sans-test',
        conseils: 'contact-a-risque-variante-d-interet',
    },
    {
        description: 'Pas testé et contact à risque même lieu de vie',
        profil: {
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
            depistage: false,
        },
        situation: 'pas_teste_contact_a_risque_meme_lieu_de_vie',
        statut: 'contact-a-risque-meme-lieu-de-vie-sans-depistage',
        conseils: 'contact-a-risque-meme-lieu-de-vie-sans-depistage',
    },
    {
        description: 'Pas testé et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: false,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Pas testé et contact pas vraiment à risque + personne fragile',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: false,
            age: 70,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'personne-fragile',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Pas testé et contact pas vraiment à risque',
        profil: {
            contact_a_risque: true,
            contact_a_risque_autre: true,
            depistage: false,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Pas testé et rien de tout ça',
        profil: {},
        situation: 'pas_teste_asymptomatique',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Pas testé et rien de tout ça + personne fragile',
        profil: {
            age: 70,
        },
        situation: 'pas_teste_asymptomatique',
        statut: 'personne-fragile',
        conseils: null,
    },
    {
        description: 'Test négatif obsolète et symptômes actuels graves',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
        },
        situation: 'pas_teste_symptomes_actuels_graves',
        statut: 'symptomatique-urgent',
        conseils: 'symptomes-actuels-sans-depistage-critique',
    },
    {
        description: 'Test négatif obsolète et symptômes actuels',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
        },
        situation: 'pas_teste_symptomes_actuels',
        statut: 'symptomatique-sans-test',
        conseils: 'symptomes-actuels-sans-depistage',
    },
    {
        description: 'Test négatif obsolète et symptômes passés',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            symptomes_passes: true,
        },
        situation: 'pas_teste_symptomes_passes',
        statut: 'symptomatique-sans-test',
        conseils: 'symptomes-passes-sans-depistage',
    },
    {
        description: 'Test négatif obsolète et contact à risque',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
        },
        situation: 'pas_teste_contact_a_risque',
        statut: 'contact-a-risque-sans-test',
        conseils: 'contact-a-risque',
    },
    {
        description: 'Test négatif obsolète et contact à risque même lieu de vie',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
        },
        situation: 'pas_teste_contact_a_risque_meme_lieu_de_vie',
        statut: 'contact-a-risque-meme-lieu-de-vie-sans-depistage',
        conseils: 'contact-a-risque-meme-lieu-de-vie-sans-depistage',
    },
    {
        description: 'Test négatif obsolète et contact pas vraiment à risque',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            contact_a_risque: true,
            contact_a_risque_autre: true,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description:
            'Test négatif obsolète et contact pas vraiment à risque + personne fragile',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            contact_a_risque: true,
            contact_a_risque_autre: true,
            age: 70,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'personne-fragile',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Test négatif obsolète et contact pas vraiment à risque',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            contact_a_risque: true,
            contact_a_risque_autre: true,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Test négatif obsolète et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
        },
        situation: 'pas_teste_asymptomatique',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Test négatif obsolète et rien de tout ça + personne fragile',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'negatif',
            _depistage_start_date: joursAvant(7),
            age: 70,
        },
        situation: 'pas_teste_asymptomatique',
        statut: 'personne-fragile',
        conseils: null,
    },
    {
        description: 'Test positif obsolète et symptômes actuels graves',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            symptomes_actuels: true,
            symptomes_actuels_souffle: true,
        },
        situation: 'pas_teste_symptomes_actuels_graves',
        statut: 'symptomatique-urgent',
        conseils: 'symptomes-actuels-sans-depistage-critique',
    },
    {
        description: 'Test positif obsolète et symptômes actuels',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            symptomes_actuels: true,
            symptomes_actuels_diarrhee: true,
        },
        situation: 'pas_teste_symptomes_actuels',
        statut: 'symptomatique-sans-test',
        conseils: 'symptomes-actuels-sans-depistage',
    },
    {
        description: 'Test positif obsolète et symptômes passés',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            symptomes_passes: true,
        },
        situation: 'pas_teste_symptomes_passes',
        statut: 'symptomatique-sans-test',
        conseils: 'symptomes-passes-sans-depistage',
    },
    {
        description: 'Test positif obsolète et contact à risque',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            contact_a_risque: true,
            contact_a_risque_contact_direct: true,
        },
        situation: 'pas_teste_contact_a_risque',
        statut: 'contact-a-risque-sans-test',
        conseils: 'contact-a-risque',
    },
    {
        description: 'Test positif obsolète et contact à risque même lieu de vie',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            contact_a_risque: true,
            contact_a_risque_meme_lieu_de_vie: true,
        },
        situation: 'pas_teste_contact_a_risque_meme_lieu_de_vie',
        statut: 'contact-a-risque-meme-lieu-de-vie-sans-depistage',
        conseils: 'contact-a-risque-meme-lieu-de-vie-sans-depistage',
    },
    {
        description: 'Test positif obsolète et contact pas vraiment à risque',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            contact_a_risque: true,
            contact_a_risque_autre: true,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description:
            'Test positif obsolète et contact pas vraiment à risque + personne fragile',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            contact_a_risque: true,
            contact_a_risque_autre: true,
            age: 70,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'personne-fragile',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Test positif obsolète et contact pas vraiment à risque',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            contact_a_risque: true,
            contact_a_risque_autre: true,
        },
        situation: 'pas_teste_contact_pas_vraiment_a_risque',
        statut: 'peu-de-risques',
        conseils: 'contact-a-risque-autre',
    },
    {
        description: 'Test positif obsolète et rien de tout ça',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
        },
        situation: 'pas_teste_asymptomatique',
        statut: 'peu-de-risques',
        conseils: null,
    },
    {
        description: 'Test positif obsolète et rien de tout ça + personne fragile',
        profil: {
            depistage: true,
            depistage_type: 'rt-pcr',
            depistage_resultat: 'positif',
            _depistage_start_date: joursAvant(14),
            age: 70,
        },
        situation: 'pas_teste_asymptomatique',
        statut: 'personne-fragile',
        conseils: null,
    },
]

describe('Situation, statut et conseils personnels selon profil', function () {
    itParam('${value.description}', matrice, function (cas) {
        const profil = createProfil(cas.profil)
        assert.isTrue(profil.isComplete())

        const algo = new AlgorithmeOrientation(profil, {})
        assert.equal(algo.situation, cas.situation)
        assert.deepEqual(algo.statutEtConseils, {
            statut: cas.statut,
            conseils: cas.conseils,
        })
    })
})
